@import "tailwindcss/base";
@import "tailwindcss/components";
@import "tailwindcss/utilities";

/* Telegram WebApp specific fixes */
@layer base {
  /* Ensure clickability in Telegram WebApp */
  html, body {
    touch-action: auto;
    -webkit-tap-highlight-color: rgba(139, 92, 246, 0.1);
  }

  /* Fix for Telegram WebApp viewport issues */
  body {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    overscroll-behavior: none;
  }

  /* Ensure all interactive elements are clickable */
  button, a, input, textarea, select, [role="button"], [data-burger], [data-mobile-link] {
    touch-action: manipulation;
    -webkit-tap-highlight-color: rgba(139, 92, 246, 0.15);
    cursor: pointer;
    /* Ensure proper event handling */
    pointer-events: auto;
    position: relative;
  }

  /* Make buttons more tappable on mobile */
  button, [role="button"], .neo-brutal-btn, .neo-brutal-btn-sm {
    min-height: 44px;
    min-width: 44px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  /* Mobile menu specific fixes for Telegram */
  .mobile-menu-open {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
  }

  /* Ensure portal elements are above everything */
  #mobile-nav-portal {
    isolation: isolate;
  }
}

/* Neobrutalism Design System */

@layer components {
  /* Cards - Mobile optimized */
  .neo-brutal-card {
    @apply bg-white border-2 sm:border-4 border-black p-3 sm:p-6 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] sm:shadow-[8px_8px_0px_0px_rgba(0,0,0,1)];
  }

  /* Buttons - Mobile optimized */
  .neo-brutal-btn {
    @apply px-4 sm:px-6 py-2 sm:py-3 font-black uppercase border-2 sm:border-4 border-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] sm:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all active:shadow-none active:translate-x-[3px] active:translate-y-[3px] sm:hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] sm:hover:translate-x-[2px] sm:hover:translate-y-[2px];
  }

  .neo-brutal-btn-sm {
    @apply px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm font-black uppercase border-2 border-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] sm:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] transition-all active:shadow-none active:translate-x-[2px] active:translate-y-[2px] sm:hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)];
  }

  /* Inputs */
  .neo-brutal-input {
    @apply px-4 py-3 border-4 border-black font-bold focus:outline-none focus:ring-0 focus:border-blue-500;
  }

  /* Tables */
  .neo-brutal-table {
    @apply w-full border-4 border-black;
  }

  .neo-brutal-table thead {
    @apply bg-black text-white;
  }

  .neo-brutal-table th {
    @apply px-4 py-3 text-left font-black uppercase text-sm border-r-2 border-white last:border-r-0;
  }

  .neo-brutal-table td {
    @apply px-4 py-3 border-t-2 border-b-2 border-black font-medium;
  }

  .neo-brutal-table tbody tr:nth-child(odd) {
    @apply bg-white;
  }

  .neo-brutal-table tbody tr:nth-child(even) {
    @apply bg-gray-50;
  }

  /* Badges */
  .neo-brutal-badge {
    @apply inline-block px-3 py-1 font-black uppercase text-xs border-2 border-black;
  }

  /* Alerts */
  .neo-brutal-alert {
    @apply border-4 border-black p-4 font-bold shadow-[6px_6px_0px_0px_rgba(0,0,0,1)];
  }
}

/* Custom Utilities */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* LiveView specific styles */
.phx-no-feedback.invalid-feedback,
.phx-no-feedback .invalid-feedback {
  display: none;
}

.phx-click-loading {
  opacity: 0.5;
  transition: opacity 1s ease-out;
}

.phx-loading {
  cursor: wait;
}

.phx-modal {
  opacity: 1 !important;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
}

.phx-modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 4px solid #000;
  width: 80%;
  max-width: 600px;
  box-shadow: 8px 8px 0px 0px rgba(0, 0, 0, 1);
}

.fade-in-scale {
  animation: 0.2s ease-in 0s normal forwards 1 fade-in-scale-keys;
}

.fade-out-scale {
  animation: 0.2s ease-out 0s normal forwards 1 fade-out-scale-keys;
}

.fade-in {
  animation: 0.2s ease-out 0s normal forwards 1 fade-in-keys;
}

.fade-out {
  animation: 0.2s ease-out 0s normal forwards 1 fade-out-keys;
}

/* Mobile nav hardening for Telegram in-app */
:root.mobile-menu-open,
body.mobile-menu-open {
  overflow: hidden !important;
}

/* Backdrop styling - NO PORTAL */
[data-backdrop] {
  position: fixed !important;
  inset: 0 !important;
  z-index: 9998 !important;
}

/* Menu drawer styling - NO PORTAL */
[data-mobile-menu] {
  position: fixed !important;
  top: 0 !important;
  right: 0 !important;
  height: 100dvh !important;
  max-height: 100dvh !important;
  z-index: 9999 !important;
  pointer-events: auto !important;
  padding-bottom: env(safe-area-inset-bottom, 0) !important;
}

@keyframes fade-in-scale-keys {
  0% {
    scale: 0.95;
    opacity: 0;
  }
  100% {
    scale: 1;
    opacity: 1;
  }
}

@keyframes fade-out-scale-keys {
  0% {
    scale: 1;
    opacity: 1;
  }
  100% {
    scale: 0.95;
    opacity: 0;
  }
}

@keyframes fade-in-keys {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

@keyframes fade-out-keys {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
