# üö® –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø –õ–Ü–ß–ò–õ–¨–ù–ò–ö–Ü–í DASHBOARD

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ—ñ—á–∏–ª—å–Ω–∏–∫–∏ –ø–æ–∫–∞–∑—É—é—Ç—å 0, analytics 2.0 –Ω–µ –ø—Ä–∞—Ü—é—î

**–ü—Ä–∏—á–∏–Ω–∞:** Analytics snapshots –Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞–ª–∏—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

---

## ‚úÖ –®–í–ò–î–ö–ï –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø (2 —Ö–≤–∏–ª–∏–Ω–∏)

### –ö—Ä–æ–∫ 1: –î–æ—á–µ–∫–∞–π—Ç–µ—Å—è –¥–µ–ø–ª–æ—é –Ω–∞ Railway

–ö–æ–¥ –≤–∂–µ –∑–∞–ø—É—à–µ–Ω–æ –≤ GitHub. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–µ–ø–ª–æ—ó—Ç—å –∑–º—ñ–Ω–∏.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å:
```bash
railway status
```

–ê–±–æ –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è –ª–æ–≥–∏:
```bash
railway logs --service feedback-bot
```

**–î–æ—á–µ–∫–∞–π—Ç–µ—Å—è:** `[info] Running FeedbackBotWeb.Endpoint`

---

### –ö—Ä–æ–∫ 2: –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—é –≤–∏–∫–æ–Ω–∞–π—Ç–µ **–û–î–ù–£** –∫–æ–º–∞–Ω–¥—É:

```bash
railway run --service feedback-bot mix run priv/scripts/initialize_snapshots.exs
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤–∏–≤—ñ–¥:**
```
========================================
  Analytics Snapshots Initialization
========================================
Total feedbacks in database: 15
Completed feedbacks: 12

Creating snapshots...

Creating daily snapshot... ‚úÖ OK (3 feedbacks, sentiment: 0.45)
Creating weekly snapshot... ‚úÖ OK (8 feedbacks, sentiment: 0.38)
Creating monthly snapshot... ‚úÖ OK (12 feedbacks, sentiment: 0.41)

‚úÖ Analytics snapshots initialized successfully!
```

---

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Dashboard

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à –≤–µ–± –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
2. –û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É (Cmd+R / Ctrl+R)
3. –¢–µ–ø–µ—Ä –ª—ñ—á–∏–ª—å–Ω–∏–∫–∏ –º–∞—é—Ç—å –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –†–ï–ê–õ–¨–ù–Ü —Ü–∏—Ñ—Ä–∏:

```
–°–¨–û–ì–û–î–ù–Ü          –¶–¨–û–ì–û –¢–ò–ñ–ù–Ø       –¶–¨–û–ì–û –ú–Ü–°–Ø–¶–Ø
3                 8                 12
–¢–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å: 0.45 –¢–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å: 0.38 –¢–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å: 0.41
```

4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `/analytics` - –≤—Å—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ –º–∞—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏

---

## üîÑ –©–æ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ?

### 1. **Analytics.create_snapshot** - —Ç–µ–ø–µ—Ä UPSERT
- –†–∞–Ω—ñ—à–µ: –∑–∞–≤–∂–¥–∏ INSERT ‚Üí –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∞—Ö
- –¢–µ–ø–µ—Ä: –ø–µ—Ä–µ–≤—ñ—Ä—è—î —ñ—Å–Ω—É–≤–∞–Ω–Ω—è ‚Üí UPDATE –∞–±–æ INSERT
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

### 2. **initialize_all_snapshots()** - –Ω–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è
- –°—Ç–≤–æ—Ä—é—î –≤—ñ–¥—Ä–∞–∑—É –≤—Å—ñ 3 —Ç–∏–ø–∏ snapshots (daily/weekly/monthly)
- –õ–æ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è debug
- –ú–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤—Ä—É—á–Ω—É –¥–ª—è reset

### 3. **Initialization Script** - –∑—Ä—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫
- `priv/scripts/initialize_snapshots.exs`
- –ü–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º
- –î–µ—Ç–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ snapshot
- –ü—Ä–∞—Ü—é—î –Ω–∞ Railway —Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ

---

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Å–ø–æ—Å—ñ–± (—á–µ—Ä–µ–∑ IEx –∫–æ–Ω—Å–æ–ª—å)

–Ø–∫—â–æ railway CLI –Ω–µ –ø—Ä–∞—Ü—é—î:

```bash
# –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ Railway —á–µ—Ä–µ–∑ SSH –∞–±–æ IEx
railway run --service feedback-bot iex -S mix
```

–ü–æ—Ç—ñ–º –≤ –∫–æ–Ω—Å–æ–ª—ñ:
```elixir
# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–π—Ç–µ snapshots
FeedbackBot.Analytics.initialize_all_snapshots()

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
FeedbackBot.Analytics.get_latest_snapshot("daily") |> IO.inspect()
FeedbackBot.Analytics.get_latest_snapshot("weekly") |> IO.inspect()
FeedbackBot.Analytics.get_latest_snapshot("monthly") |> IO.inspect()
```

---

## ‚ö†Ô∏è –©–æ —Ä–æ–±–∏—Ç–∏ —è–∫—â–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∏ –≤—Å–µ —â–µ 0?

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 1: –ß–∏ —î –≤–∑–∞–≥–∞–ª—ñ feedbacks?

```bash
railway run --service feedback-bot mix run -e "
  total = FeedbackBot.Repo.aggregate(FeedbackBot.Feedbacks.Feedback, :count, :id)
  completed = FeedbackBot.Repo.one(
    from f in FeedbackBot.Feedbacks.Feedback,
    where: f.processing_status == \"completed\",
    select: count(f.id)
  )
  IO.puts(\"Total: #{total}, Completed: #{completed}\")
"
```

**–Ø–∫—â–æ –ø–æ–∫–∞–∑—É—î 0** ‚Üí –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –≥–æ–ª–æ—Å–æ–≤—ñ —Ñ—ñ–¥–±–µ–∫–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 2: –ß–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏—Å—è snapshots?

```bash
railway run --service feedback-bot mix run -e "
  snapshots = FeedbackBot.Repo.all(FeedbackBot.Analytics.Snapshot)
  IO.puts(\"Snapshots: #{length(snapshots)}\")
  for s <- snapshots do
    IO.puts(\"#{s.period_type}: #{s.total_feedbacks} feedbacks\")
  end
"
```

**–Ø–∫—â–æ –ø–æ–∫–∞–∑—É—î 0** ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ 3: –ß–∏ —î –ø–æ–º–∏–ª–∫–∏ –≤ –ª–æ–≥–∞—Ö?

```bash
railway logs --service feedback-bot | grep ERROR
```

**–Ø–∫—â–æ –±–∞—á–∏—Ç–µ –ø–æ–º–∏–ª–∫–∏** ‚Üí –Ω–∞–¥—ñ—à–ª—ñ—Ç—å –º–µ–Ω—ñ –≤–∏–≤—ñ–¥ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üìä –Ø–∫ –ø—Ä–∞—Ü—é—î Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è?

–ü—ñ—Å–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó snapshots:

1. **–ó–∞–ø–∏—Å –Ω–æ–≤–æ–≥–æ —Ñ—ñ–¥–±–µ–∫—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞**
   ‚Üì
2. **ProcessAudioJob –æ–±—Ä–æ–±–ª—è—î –∞—É–¥—ñ–æ**
   ‚Üì
3. **–ó–±–µ—Ä—ñ–≥–∞—î feedback –≤ –ë–î**
   ‚Üì
4. **Broadcast —á–µ—Ä–µ–∑ PubSub: `{:new_feedback, feedback}`**
   ‚Üì
5. **UpdateAnalyticsJob —Å—Ç–≤–æ—Ä—é—î/–æ–Ω–æ–≤–ª—é—î snapshots**
   ‚Üì
6. **DashboardLive –æ—Ç—Ä–∏–º—É—î broadcast**
   ‚Üì
7. **Dashboard –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –¥–∞–Ω—ñ**
   ‚Üì
8. **–õ—ñ—á–∏–ª—å–Ω–∏–∫–∏ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –ë–ï–ó REFRESH (< 5 —Å–µ–∫—É–Ω–¥)**

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

- [ ] Railway deploy –∑–∞–≤–µ—Ä—à–∏–≤—Å—è —É—Å–ø—ñ—à–Ω–æ
- [ ] –°–∫—Ä–∏–ø—Ç initialize_snapshots.exs –≤–∏–∫–æ–Ω–∞–≤—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- [ ] Dashboard –ø–æ–∫–∞–∑—É—î —á–∏—Å–ª–∞ –∑–∞–º—ñ—Å—Ç—å –Ω—É–ª—ñ–≤
- [ ] Analytics 2.0 (/analytics) –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- [ ] –í—Å—ñ 6 –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —Ä–µ–Ω–¥–µ—Ä—è—Ç—å—Å—è
- [ ] –¢–µ—Å—Ç–æ–≤–∏–π —Ñ—ñ–¥–±–µ–∫ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –æ–Ω–æ–≤–ª—é—î dashboard –∑–∞ < 5 —Å–µ–∫—É–Ω–¥

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–õ—ñ—á–∏–ª—å–Ω–∏–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å**
‚úÖ **Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î**
‚úÖ **Analytics 2.0 –ø—Ä–∞—Ü—é—î**
‚úÖ **–í—Å—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å**

**–ß–∞—Å –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** 2-5 —Ö–≤–∏–ª–∏–Ω

---

**–°—Ç–≤–æ—Ä–µ–Ω–æ:** 2025-12-09
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –î–û –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø
